<script>
  function loadMermaid() {
    if (document.getElementsByClassName('mermaid').length) {
      if (window.mermaidJsLoad) mermaid.init()
      else {
        loadScript('<%- theme.mermaid.cdn %>').then(() => {
          window.mermaidJsLoad = true
          mermaid.initialize({
            theme: '<%= theme.mermaid.theme %>',
          })
          if ('<%= theme.pjax.on %>') {
            mermaid.init();
          }
        })
      }
    }
  };
  document.addEventListener("DOMContentLoaded", function () {
    loadMermaid();
  })

  document.addEventListener('pjax:complete', function () {
    loadMermaid();
  })
  
</script>
